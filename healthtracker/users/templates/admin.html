{% extends "layouts/layout.html" %}
{% from 'macros/admin_nav.html' import admin_nav with context %}
{% block body %}
<div class="container">
  {{ admin_nav("users") }}
  {% include "macros/flash.html" %}
  <div>
    <div class="users">
      <table class="table">
        <tbody>
          {% for user in users %}
          <tr>
            <td>
              {% if user.is_confirmed %}
              <i class="icon-check"></i>
              {% else %}
              <i class="icon-remove"></i>
              {% endif %}
              <a href="/users/{{ user.id }}/edit?auth_token={{ auth_token }}">{{ user.email }}</a>
              {% if user.is_admin %}<span class="label label-info">admin</span>{% endif %}
            </td>

            <td>
              <tt><span title="{{ user.auth_token }}">{{ user.auth_token[10:] + '...' }}</span></tt>
              <form style="display:inline-block;" action="/users/reset_auth" method="post">
                <input type="hidden" name="user_id" value="{{user.id}}">
                <input type="hidden" name="auth_token" value="{{auth_token}}">
                <button class="btn btn-warning btn-mini" type="submit"><i class="icon-repeat icon-white"></i></button>
              </form>
            </td>

            <td>
              <form style="display:inline-block;" action="/users/toggle_approve" method="post">
                <input type="hidden" name="user_id" value="{{user.id}}">
                <input type="hidden" name="auth_token" value="{{auth_token}}">
                {% if not user.is_approved %}
                <input class="btn btn-primary btn-mini" value="Approve" type="submit">
                {% else %}
                <input class="btn btn-warning btn-mini" value="Unapprove" type="submit">
                {% endif %}
              </form>

<!--              <form style="display:inline-block;" action="/users/delete" method="post">
                <input type="hidden" name="user_id" value="{{user.id}}">
                <input type="hidden" name="auth_token" value="{{auth_token}}">
                <button class="btn btn-danger btn-mini" type="submit"><i class="icon-remove-sign icon-white"></i></button>
              </form>
-->

              <form style="display:inline-block;"
                    action="/users/{{user.id}}/send_update_email"
                    method="post">
                <input type="hidden" name="auth_token" value="{{auth_token}}">
                <input class="btn btn-primary btn-mini" value="Send Update Email" type="submit">
              </form>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>
{% endblock %}
